<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Visual Predictive Check (VPC) using XPOSE — xpose.VPC • xpose4</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visual Predictive Check (VPC) using XPOSE — xpose.VPC"><meta name="description" content="This Function is used to create a VPC in xpose using the output from the
vpc command in Pearl Speaks NONMEM (PsN).  The function reads in the
output files created by PsN and creates a plot from the data.  The dependent
variable, independent variable and conditioning variable are automatically
determined from the PsN files."><meta property="og:description" content="This Function is used to create a VPC in xpose using the output from the
vpc command in Pearl Speaks NONMEM (PsN).  The function reads in the
output files created by PsN and creates a plot from the data.  The dependent
variable, independent variable and conditioning variable are automatically
determined from the PsN files."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">xpose4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">4.7.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UUPharmacometrics/xpose4/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Visual Predictive Check (VPC) using XPOSE</h1>
      <small class="dont-index">Source: <a href="https://github.com/UUPharmacometrics/xpose4/blob/master/R/xpose.VPC.R" class="external-link"><code>R/xpose.VPC.R</code></a></small>
      <div class="d-none name"><code>xpose.VPC.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This Function is used to create a VPC in xpose using the output from the
<code>vpc</code> command in Pearl Speaks NONMEM (PsN).  The function reads in the
output files created by PsN and creates a plot from the data.  The dependent
variable, independent variable and conditioning variable are automatically
determined from the PsN files.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">xpose.VPC</span><span class="op">(</span></span>
<span>  vpc.info <span class="op">=</span> <span class="st">"vpc_results.csv"</span>,</span>
<span>  vpctab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"^vpctab"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  object <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ids <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"p"</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  PI <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  PI.ci <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>  PI.ci.area.smooth <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  PI.real <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Default"</span>,</span>
<span>  main.sub <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main.sub.cex <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  inclZeroWRES <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  force.x.continuous <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  funy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  logy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ylb <span class="op">=</span> <span class="st">"Default"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  PI.x.median <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  PI.rug <span class="op">=</span> <span class="st">"Default"</span>,</span>
<span>  PI.identify.outliers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-vpc-info">vpc.info<a class="anchor" aria-label="anchor" href="#arg-vpc-info"></a></dt>
<dd><p>The results file from the <code>vpc</code> command in PsN. for
example <code class="file">vpc_results.csv</code>, or if the file is in a separate directory
<code class="file">./vpc_dir1/vpc_results.csv</code>.</p></dd>


<dt id="arg-vpctab">vpctab<a class="anchor" aria-label="anchor" href="#arg-vpctab"></a></dt>
<dd><p>The <code class="file">vpctab</code> from the <code>vpc</code> command in PsN.  For
example <code class="file">vpctab5</code>, or if the file is in a separate directory
<code class="file">./vpc_dir1/vpctab5</code>.  Can be <code>NULL</code>.  The default looks in the
current working directory and takes the first file that starts with
<code class="file">vpctab</code> that it finds.  Note that this default can result in the
wrong files being read if there are multiple <code class="file">vpctab</code> files in the
directory. One of <code>object</code> or <code>vpctab</code> is required.  If both are
present then the information from the <code>vpctab</code> will over-ride the
xpose data object <code>object</code> (i.e. the values from the vpctab will
replace any matching values in the <code>object\@Data</code> portion of the xpose
data object).</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An xpose data object. Created from <code><a href="xpose.data.html">xpose.data</a></code>.
One of <code>object</code> or <code>vpctab</code> is required.  If both are present
then the information from the <code>vpctab</code> will over-ride the xpose data
object <code>object</code> (i.e. the values from the vpctab will replace any
matching values in the <code>object\@Data</code> portion of the xpose data
object).</p></dd>


<dt id="arg-ids">ids<a class="anchor" aria-label="anchor" href="#arg-ids"></a></dt>
<dd><p>A logical value indicating whether text ID labels should be used
as plotting symbols (the variable used for these symbols indicated by the
<code>idlab</code> xpose data variable). Can be <code>FALSE</code> or <code>TRUE</code>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Character string describing the way the points in the plot will
be displayed. For more details, see <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code>. Use
<code>type="n"</code> if you don't want observations in the plot.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>A string or a vector of strings with the name(s) of the
conditioning variables. For example <code>by = c("SEX","WT")</code>.  Because the
function automatically determines the conditioning variable from the PsN
input file specified in <code>vpc.info</code>, the <code>by</code> command can control
if separate plots are created for each condition (<code>by=NULL</code>), or if a
conditioning plot should be created (<code>by="WT"</code> for example).  If the
<code>vpc.info</code> file has a conditioning variable then <code>by</code> must match
that variable.  If there is no conditioning variable in <code>vpc.info</code>
then the <code>PI</code> for each conditioned plot will be the <code>PI</code> for the
entire data set (not only for the conditioning subset).</p></dd>


<dt id="arg-pi">PI<a class="anchor" aria-label="anchor" href="#arg-pi"></a></dt>
<dd><p>Either "lines", "area" or "both" specifying whether prediction
intervals (as lines, a shaded area or both) should be added to the plot.
<code>NULL</code> means no prediction interval.</p></dd>


<dt id="arg-pi-ci">PI.ci<a class="anchor" aria-label="anchor" href="#arg-pi-ci"></a></dt>
<dd><p>Plot the confidence interval for the simulated data's
percentiles for each bin (for each simulated data set compute the
percentiles for each bin, then, from all of the percentiles from all of the
simulated datasets compute the 95% CI of these percentiles). Values can be
<code>"both"</code>, <code>"area"</code> or <code>"lines"</code>. These CIs can be used to
asses the <code>PI.real</code> values for model misspecification. Note that with
few observations per bin the CIs will be approximate because the
percentiles in each bin will be approximate. For example, the 95th
percentile of 4 data points will always be the largest of the 4 data
points.</p></dd>


<dt id="arg-pi-ci-area-smooth">PI.ci.area.smooth<a class="anchor" aria-label="anchor" href="#arg-pi-ci-area-smooth"></a></dt>
<dd><p>Should the "area" for <code>PI.ci</code> be smoothed to
match the "lines" argument? Allowed values are <code>TRUE/FALSE</code>. The "area"
is set by default to show the bins used in the <code>PI.ci</code> computation.  By
smoothing, information is lost and, in general, the confidence intervals
will be smaller than they are in reality.</p></dd>


<dt id="arg-pi-real">PI.real<a class="anchor" aria-label="anchor" href="#arg-pi-real"></a></dt>
<dd><p>Plot the percentiles of the real data in the various bins.
values can be NULL or TRUE.  Note that for a bin with few actual
observations the percentiles will be approximate.  For example, the 95th
percentile of 4 data points will always be the largest of the 4 data
points.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>A string giving the subset expression to be applied to the data
before plotting. See <code><a href="xsubset.html">xsubset</a></code>.</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>A string giving the plot title or <code>NULL</code> if none.
<code>"Default"</code> creates a default title.</p></dd>


<dt id="arg-main-sub">main.sub<a class="anchor" aria-label="anchor" href="#arg-main-sub"></a></dt>
<dd><p>Used for names above each plot when using multiple plots.
Should be a vector <code>c("Group 1","Group 2")</code></p></dd>


<dt id="arg-main-sub-cex">main.sub.cex<a class="anchor" aria-label="anchor" href="#arg-main-sub-cex"></a></dt>
<dd><p>The size of the <code>main.sub</code> titles.</p></dd>


<dt id="arg-inclzerowres">inclZeroWRES<a class="anchor" aria-label="anchor" href="#arg-inclzerowres"></a></dt>
<dd><p>Logical value indicating whether rows with WRES=0 is
included in the plot.</p></dd>


<dt id="arg-force-x-continuous">force.x.continuous<a class="anchor" aria-label="anchor" href="#arg-force-x-continuous"></a></dt>
<dd><p>Logical value indicating whether x-values should be
converted to continuous variables, even if they are defined as factors.</p></dd>


<dt id="arg-funy">funy<a class="anchor" aria-label="anchor" href="#arg-funy"></a></dt>
<dd><p>String of function to apply to Y data. For example "abs"</p></dd>


<dt id="arg-logy">logy<a class="anchor" aria-label="anchor" href="#arg-logy"></a></dt>
<dd><p>Logical value indicating whether the y-axis should be
logarithmic, base 10.</p></dd>


<dt id="arg-ylb">ylb<a class="anchor" aria-label="anchor" href="#arg-ylb"></a></dt>
<dd><p>Label for the y-axis</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Should warning messages and other diagnostic information be
passed to screen? (TRUE or FALSE)</p></dd>


<dt id="arg-pi-x-median">PI.x.median<a class="anchor" aria-label="anchor" href="#arg-pi-x-median"></a></dt>
<dd><p>Should the x-location of percentile lines in a bin be
marked at the median of the x-values? (<code>TRUE</code> or <code>FALSE</code>)</p></dd>


<dt id="arg-pi-rug">PI.rug<a class="anchor" aria-label="anchor" href="#arg-pi-rug"></a></dt>
<dd><p>Should there be markings on the plot showing where the binning intervals
for the VPC are
(or the locations of the independent variable used for each VPC calculation if binning is not used)?</p></dd>


<dt id="arg-pi-identify-outliers">PI.identify.outliers<a class="anchor" aria-label="anchor" href="#arg-pi-identify-outliers"></a></dt>
<dd><p>Should outlying percentiles of the real data be highlighted? (TRUE of FALSE)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to <code><a href="xpose.panel.default.html">xpose.panel.default</a></code>,
<code><a href="xpose.plot.default.html">xpose.plot.default</a></code> and others. Please see these functions for
more descriptions of what you can do.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A plot or a list of plots.</p>
    </div>
    <div class="section level2">
    <h2 id="additional-arguments">Additional arguments<a class="anchor" aria-label="anchor" href="#additional-arguments"></a></h2>



<p>Below are some of the additional arguments that can control the look and
  feel of the VPC.  See
  <code><a href="xpose.panel.default.html">xpose.panel.default</a></code> for all potential options.</p>
<p><strong>Additional graphical elements available in the VPC plots.<br></strong></p>
<p></p><dl><dt> PI.mirror = NULL, TRUE or AN.INTEGER.VALUE</dt>
<dd><p>Plot the percentiles of
  one simulated data set in each bin. <code>TRUE</code> takes the first mirror from
  <code class="file">vpc_results.csv</code> and <code>AN.INTEGER.VALUE</code> can be <code>1, 2,
  ...{} n</code> where <code>n</code> is the number of mirror's output in the
  <code class="file">vpc_results.csv</code> file.</p></dd>

  <dt> PI.limits = c(0.025, 0.975)</dt>
<dd><p>A vector of two
  values that describe the limits of the prediction interval that should be
  displayed.  These limits should be found in the <code class="file">vpc_results.csv</code>
  file. These limits are also used as the percentages for the <code>PI.real,
  PI.mirror</code> and <code>PI.ci</code>.  However, the confidence interval in
  <code>PI.ci</code> is always the one defined in the <code class="file">vpc_results.csv</code> file.</p></dd>


</dl><p><strong>Additional options to control the look and feel of the <code>PI</code>.
  See See <code><a href="https://rdrr.io/r/grid/grid.polygon.html" class="external-link">grid.polygon</a></code> and <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code>
  for more details.<br></strong></p>
<p></p><dl><dt> PI.arcol</dt>
<dd><p>The color of the <code>PI</code> area</p></dd>
 <dt>
  PI.up.lty</dt>
<dd><p>The upper line type. can be "dotted" or "dashed", etc.</p></dd>
 <dt>
  PI.up.type</dt>
<dd><p>The upper type used for plotting.  Defaults to a line.</p></dd>
 <dt>
  PI.up.col</dt>
<dd><p>The upper line color</p></dd>
 <dt> PI.up.lwd</dt>
<dd><p>The upper line width</p></dd>

  <dt> PI.down.lty</dt>
<dd><p>The lower line type. can be "dotted" or "dashed", etc.</p></dd>

  <dt> PI.down.type</dt>
<dd><p>The lower type used for plotting. Defaults to a line.</p></dd>

  <dt> PI.down.col</dt>
<dd><p>The lower line color</p></dd>
 <dt> PI.down.lwd</dt>
<dd><p>The lower
  line width</p></dd>
 <dt> PI.med.lty</dt>
<dd><p>The median line type. can be "dotted" or
  "dashed", etc.</p></dd>
 <dt> PI.med.type</dt>
<dd><p>The median type used for plotting.
  Defaults to a line.</p></dd>
 <dt> PI.med.col</dt>
<dd><p>The median line color</p></dd>
 <dt>
  PI.med.lwd</dt>
<dd><p>The median line width</p></dd>

</dl><p><strong>Additional options to control the look and feel of the
  <code>PI.ci</code>. See See <code><a href="https://rdrr.io/r/grid/grid.polygon.html" class="external-link">grid.polygon</a></code> and
  <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code> for more details.<br></strong></p>
<p></p><dl><dt> PI.ci.up.arcol</dt>
<dd><p>The color of the upper <code>PI.ci</code>.</p></dd>

  <dt> PI.ci.med.arcol</dt>
<dd><p>The color of the median <code>PI.ci</code>.</p></dd>
 <dt>
  PI.ci.down.arcol</dt>
<dd><p>The color of the lower <code>PI.ci</code>.</p></dd>
 <dt>
  PI.ci.up.lty</dt>
<dd><p>The upper line type. can be "dotted" or "dashed", etc.</p></dd>

  <dt> PI.ci.up.type</dt>
<dd><p>The upper type used for plotting.  Defaults to a
  line.</p></dd>
 <dt> PI.ci.up.col</dt>
<dd><p>The upper line color</p></dd>
 <dt> PI.ci.up.lwd</dt>
<dd><p>The
  upper line width</p></dd>
 <dt> PI.ci.down.lty</dt>
<dd><p>The lower line type. can be
  "dotted" or "dashed", etc.</p></dd>
 <dt> PI.ci.down.type</dt>
<dd><p>The lower type used for
  plotting.  Defaults to a line.</p></dd>
 <dt> PI.ci.down.col</dt>
<dd><p>The lower line
  color</p></dd>
 <dt> PI.ci.down.lwd</dt>
<dd><p>The lower line width</p></dd>
 <dt>
  PI.ci.med.lty</dt>
<dd><p>The median line type. can be "dotted" or "dashed", etc.</p></dd>

  <dt> PI.ci.med.type</dt>
<dd><p>The median type used for plotting.  Defaults to a
  line.</p></dd>
 <dt> PI.ci.med.col</dt>
<dd><p>The median line color</p></dd>
 <dt>
  PI.ci.med.lwd</dt>
<dd><p>The median line width</p></dd>
 <dt>PI.ci.area.smooth</dt>
<dd><p>Should the
  "area" for <code>PI.ci</code> be smoothed to match the "lines" argument? Allowed
  values are <code>TRUE/FALSE</code>. The "area" is set by default to show the bins
  used in the <code>PI.ci</code> computation.  By smoothing, information is lost
  and, in general, the confidence intervals will be smaller than they are in
  reality.</p></dd>

</dl><p><strong>Additional options to control the look and feel of the
  <code>PI.real</code>. See See <code><a href="https://rdrr.io/r/grid/grid.polygon.html" class="external-link">grid.polygon</a></code> and
  <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code> for more details.<br></strong></p>
<p></p><dl><dt> PI.real.up.lty</dt>
<dd><p>The upper line type. can be "dotted" or
  "dashed", etc.</p></dd>
 <dt> PI.real.up.type</dt>
<dd><p>The upper type used for plotting.
  Defaults to a line.</p></dd>
 <dt> PI.real.up.col</dt>
<dd><p>The upper line color</p></dd>
 <dt>
  PI.real.up.lwd</dt>
<dd><p>The upper line width</p></dd>
 <dt> PI.real.down.lty</dt>
<dd><p>The lower
  line type. can be "dotted" or "dashed", etc.</p></dd>
 <dt> PI.real.down.type</dt>
<dd><p>The
  lower type used for plotting.  Defaults to a line.</p></dd>
 <dt>
  PI.real.down.col</dt>
<dd><p>The lower line color</p></dd>
 <dt> PI.real.down.lwd</dt>
<dd><p>The lower
  line width</p></dd>
 <dt> PI.real.med.lty</dt>
<dd><p>The median line type. can be "dotted"
  or "dashed", etc.</p></dd>
 <dt> PI.real.med.type</dt>
<dd><p>The median type used for
  plotting.  Defaults to a line.</p></dd>
 <dt> PI.real.med.col</dt>
<dd><p>The median line
  color</p></dd>
 <dt> PI.real.med.lwd</dt>
<dd><p>The median line width</p></dd>

</dl><p><strong>Additional options to control the look and feel of the
  <code>PI.mirror</code>. See See <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code> for more
  details.<br></strong></p>
<p></p><dl><dt>PI.mirror.up.lty</dt>
<dd><p>The upper line type. can be "dotted" or
  "dashed", etc.</p></dd>
 <dt> PI.mirror.up.type</dt>
<dd><p>The upper type used for plotting.
  Defaults to a line.</p></dd>
 <dt> PI.mirror.up.col</dt>
<dd><p>The upper line color</p></dd>
 <dt>
  PI.mirror.up.lwd</dt>
<dd><p>The upper line width</p></dd>
 <dt> PI.mirror.down.lty</dt>
<dd><p>The
  lower line type. can be "dotted" or "dashed", etc.</p></dd>
 <dt>
  PI.mirror.down.type</dt>
<dd><p>The lower type used for plotting.  Defaults to a
  line.</p></dd>
 <dt> PI.mirror.down.col</dt>
<dd><p>The lower line color</p></dd>
 <dt>
  PI.mirror.down.lwd</dt>
<dd><p>The lower line width</p></dd>
 <dt> PI.mirror.med.lty</dt>
<dd><p>The
  median line type. can be "dotted" or "dashed", etc.</p></dd>
 <dt>
  PI.mirror.med.type</dt>
<dd><p>The median type used for plotting.  Defaults to a
  line.</p></dd>
 <dt> PI.mirror.med.col</dt>
<dd><p>The median line color</p></dd>
 <dt>
  PI.mirror.med.lwd</dt>
<dd><p>The median line width</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="read.vpctab.html">read.vpctab</a></code> <code><a href="read.npc.vpc.results.html">read.npc.vpc.results</a></code>
  <code><a href="xpose.panel.default.html">xpose.panel.default</a></code> <code><a href="xpose.plot.default.html">xpose.plot.default</a></code></p>
<p>Other PsN functions:
<code><a href="boot.hist.html">boot.hist</a>()</code>,
<code><a href="bootscm.import.html">bootscm.import</a>()</code>,
<code><a href="npc.coverage.html">npc.coverage</a>()</code>,
<code><a href="randtest.hist.html">randtest.hist</a>()</code>,
<code><a href="read.npc.vpc.results.html">read.npc.vpc.results</a>()</code>,
<code><a href="read.vpctab.html">read.vpctab</a>()</code>,
<code><a href="xpose.VPC.both.html">xpose.VPC.both</a>()</code>,
<code><a href="xpose.VPC.categorical.html">xpose.VPC.categorical</a>()</code>,
<code><a href="xpose4-package.html">xpose4-package</a></code></p>
<p>Other specific functions:
<code><a href="absval.cwres.vs.cov.bw.html">absval.cwres.vs.cov.bw</a>()</code>,
<code><a href="absval.cwres.vs.pred.html">absval.cwres.vs.pred</a>()</code>,
<code><a href="absval.cwres.vs.pred.by.cov.html">absval.cwres.vs.pred.by.cov</a>()</code>,
<code><a href="absval.iwres.cwres.vs.ipred.pred.html">absval.iwres.cwres.vs.ipred.pred</a>()</code>,
<code><a href="absval.iwres.vs.cov.bw.html">absval.iwres.vs.cov.bw</a>()</code>,
<code><a href="absval.iwres.vs.idv.html">absval.iwres.vs.idv</a>()</code>,
<code><a href="absval.iwres.vs.ipred.html">absval.iwres.vs.ipred</a>()</code>,
<code><a href="absval.iwres.vs.ipred.by.cov.html">absval.iwres.vs.ipred.by.cov</a>()</code>,
<code><a href="absval.iwres.vs.pred.html">absval.iwres.vs.pred</a>()</code>,
<code><a href="absval.wres.vs.cov.bw.html">absval.wres.vs.cov.bw</a>()</code>,
<code><a href="absval.wres.vs.idv.html">absval.wres.vs.idv</a>()</code>,
<code><a href="absval.wres.vs.pred.html">absval.wres.vs.pred</a>()</code>,
<code><a href="absval.wres.vs.pred.by.cov.html">absval.wres.vs.pred.by.cov</a>()</code>,
<code><a href="absval_delta_vs_cov_model_comp.html">absval_delta_vs_cov_model_comp</a></code>,
<code><a href="addit.gof.html">addit.gof</a>()</code>,
<code><a href="autocorr.cwres.html">autocorr.cwres</a>()</code>,
<code><a href="autocorr.iwres.html">autocorr.iwres</a>()</code>,
<code><a href="autocorr.wres.html">autocorr.wres</a>()</code>,
<code><a href="basic.gof.html">basic.gof</a>()</code>,
<code><a href="basic.model.comp.html">basic.model.comp</a>()</code>,
<code><a href="cat.dv.vs.idv.sb.html">cat.dv.vs.idv.sb</a>()</code>,
<code><a href="cat.pc.html">cat.pc</a>()</code>,
<code><a href="par_cov_splom.html">cov.splom</a>()</code>,
<code><a href="cwres.dist.hist.html">cwres.dist.hist</a>()</code>,
<code><a href="cwres.dist.qq.html">cwres.dist.qq</a>()</code>,
<code><a href="cwres.vs.cov.html">cwres.vs.cov</a>()</code>,
<code><a href="cwres.vs.idv.html">cwres.vs.idv</a>()</code>,
<code><a href="cwres.vs.idv.bw.html">cwres.vs.idv.bw</a>()</code>,
<code><a href="cwres.vs.pred.html">cwres.vs.pred</a>()</code>,
<code><a href="cwres.vs.pred.bw.html">cwres.vs.pred.bw</a>()</code>,
<code><a href="cwres.wres.vs.idv.html">cwres.wres.vs.idv</a>()</code>,
<code><a href="cwres.wres.vs.pred.html">cwres.wres.vs.pred</a>()</code>,
<code><a href="dOFV.vs.cov.html">dOFV.vs.cov</a>()</code>,
<code><a href="dOFV.vs.id.html">dOFV.vs.id</a>()</code>,
<code><a href="dOFV1.vs.dOFV2.html">dOFV1.vs.dOFV2</a>()</code>,
<code><a href="data.checkout.html">data.checkout</a>()</code>,
<code><a href="dv.preds.vs.idv.html">dv.preds.vs.idv</a>()</code>,
<code><a href="dv.vs.idv.html">dv.vs.idv</a>()</code>,
<code><a href="dv.vs.ipred.html">dv.vs.ipred</a>()</code>,
<code><a href="dv.vs.ipred.by.cov.html">dv.vs.ipred.by.cov</a>()</code>,
<code><a href="dv.vs.ipred.by.idv.html">dv.vs.ipred.by.idv</a>()</code>,
<code><a href="dv.vs.pred.html">dv.vs.pred</a>()</code>,
<code><a href="dv.vs.pred.by.cov.html">dv.vs.pred.by.cov</a>()</code>,
<code><a href="dv.vs.pred.by.idv.html">dv.vs.pred.by.idv</a>()</code>,
<code><a href="dv.vs.pred.ipred.html">dv.vs.pred.ipred</a>()</code>,
<code><a href="gof.html">gof</a>()</code>,
<code><a href="ind.plots.html">ind.plots</a>()</code>,
<code><a href="ind.plots.wres.hist.html">ind.plots.cwres.hist</a>()</code>,
<code><a href="ind.plots.wres.qq.html">ind.plots.cwres.qq</a>()</code>,
<code><a href="ipred.vs.idv.html">ipred.vs.idv</a>()</code>,
<code><a href="iwres.dist.hist.html">iwres.dist.hist</a>()</code>,
<code><a href="iwres.dist.qq.html">iwres.dist.qq</a>()</code>,
<code><a href="iwres.vs.idv.html">iwres.vs.idv</a>()</code>,
<code><a href="kaplan.plot.html">kaplan.plot</a>()</code>,
<code><a href="par_cov_hist.html">par_cov_hist</a></code>,
<code><a href="par_cov_qq.html">par_cov_qq</a></code>,
<code><a href="parm.vs.cov.html">parm.vs.cov</a>()</code>,
<code><a href="parm.vs.parm.html">parm.vs.parm</a>()</code>,
<code><a href="pred.vs.idv.html">pred.vs.idv</a>()</code>,
<code><a href="ranpar.vs.cov.html">ranpar.vs.cov</a>()</code>,
<code><a href="runsum.html">runsum</a>()</code>,
<code><a href="wres.dist.hist.html">wres.dist.hist</a>()</code>,
<code><a href="wres.dist.qq.html">wres.dist.qq</a>()</code>,
<code><a href="wres.vs.idv.html">wres.vs.idv</a>()</code>,
<code><a href="wres.vs.idv.bw.html">wres.vs.idv.bw</a>()</code>,
<code><a href="wres.vs.pred.html">wres.vs.pred</a>()</code>,
<code><a href="wres.vs.pred.bw.html">wres.vs.pred.bw</a>()</code>,
<code><a href="xpose.VPC.both.html">xpose.VPC.both</a>()</code>,
<code><a href="xpose.VPC.categorical.html">xpose.VPC.categorical</a>()</code>,
<code><a href="xpose4-package.html">xpose4-package</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Andrew Hooker</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://uupharmacometrics.github.io/xpose4/" class="external-link">xpose4</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## to be more clear about which files should be read in</span></span></span>
<span class="r-in"><span><span class="va">vpc.file</span> <span class="op">&lt;-</span> <span class="st">"vpc_results.csv"</span></span></span>
<span class="r-in"><span><span class="va">vpctab</span> <span class="op">&lt;-</span> <span class="st">"vpctab5"</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span>vpc.info<span class="op">=</span><span class="va">vpc.file</span>,vpctab<span class="op">=</span><span class="va">vpctab</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## with lines and a shaded area for the prediction intervals</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span><span class="va">vpc.file</span>,vpctab<span class="op">=</span><span class="va">vpctab</span>,PI<span class="op">=</span><span class="st">"both"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## with the percentages of the real data</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span><span class="va">vpc.file</span>,vpctab<span class="op">=</span><span class="va">vpctab</span>,PI.real<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## with mirrors (if supplied in 'vpc.file')</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span><span class="va">vpc.file</span>,vpctab<span class="op">=</span><span class="va">vpctab</span>,PI.real<span class="op">=</span><span class="cn">T</span>,PI.mirror<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## with CIs</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span><span class="va">vpc.file</span>,vpctab<span class="op">=</span><span class="va">vpctab</span>,PI.real<span class="op">=</span><span class="cn">T</span>,PI.ci<span class="op">=</span><span class="st">"area"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span><span class="va">vpc.file</span>,vpctab<span class="op">=</span><span class="va">vpctab</span>,PI.real<span class="op">=</span><span class="cn">T</span>,PI.ci<span class="op">=</span><span class="st">"area"</span>,PI<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## stratification (if 'vpc.file' is stratified)</span></span></span>
<span class="r-in"><span><span class="va">cond.var</span> <span class="op">&lt;-</span> <span class="st">"WT"</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span><span class="va">vpc.file</span>,vpctab<span class="op">=</span><span class="va">vpctab</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span><span class="va">vpc.file</span>,vpctab<span class="op">=</span><span class="va">vpctab</span>,by<span class="op">=</span><span class="va">cond.var</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span>vpctab<span class="op">=</span><span class="va">vpctab</span>,vpc.info<span class="op">=</span><span class="va">vpc.file</span>,PI<span class="op">=</span><span class="st">"both"</span>,by<span class="op">=</span><span class="va">cond.var</span>,type<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## with no data points in the plot</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span><span class="va">vpc.file</span>,vpctab<span class="op">=</span><span class="va">vpctab</span>,by<span class="op">=</span><span class="va">cond.var</span>,PI.real<span class="op">=</span><span class="cn">T</span>,PI.ci<span class="op">=</span><span class="st">"area"</span>,PI<span class="op">=</span><span class="cn">NULL</span>,type<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## with different DV and IDV, just read in new files and plot</span></span></span>
<span class="r-in"><span><span class="va">vpc.file</span> <span class="op">&lt;-</span> <span class="st">"vpc_results.csv"</span></span></span>
<span class="r-in"><span><span class="va">vpctab</span> <span class="op">&lt;-</span> <span class="st">"vpctab5"</span></span></span>
<span class="r-in"><span><span class="va">cond.var</span> <span class="op">&lt;-</span> <span class="st">"WT"</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span>vpctab<span class="op">=</span><span class="va">vpctab</span>,vpc.info<span class="op">=</span><span class="va">vpc.file</span>,PI<span class="op">=</span><span class="st">"both"</span>,by<span class="op">=</span><span class="va">cond.var</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span>vpctab<span class="op">=</span><span class="va">vpctab</span>,vpc.info<span class="op">=</span><span class="va">vpc.file</span>,PI<span class="op">=</span><span class="st">"both"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## to use an xpose data object instead of vpctab</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## In this example</span></span></span>
<span class="r-in"><span><span class="co">## we expect to find the required NONMEM run and table files for run</span></span></span>
<span class="r-in"><span><span class="co">## 5 in the current working directory</span></span></span>
<span class="r-in"><span><span class="va">runnumber</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">xpdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="xpose.data.html">xpose.data</a></span><span class="op">(</span><span class="va">runnumber</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span><span class="va">vpc.file</span>,object<span class="op">=</span><span class="va">xpdb</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## to read files in a directory different than the current working directory </span></span></span>
<span class="r-in"><span><span class="va">vpc.file</span> <span class="op">&lt;-</span> <span class="st">"./vpc_strat_WT_4_mirror_5/vpc_results.csv"</span></span></span>
<span class="r-in"><span><span class="va">vpctab</span> <span class="op">&lt;-</span> <span class="st">"./vpc_strat_WT_4_mirror_5/vpctab5"</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span>vpc.info<span class="op">=</span><span class="va">vpc.file</span>,vpctab<span class="op">=</span><span class="va">vpctab</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## to rearrange order of factors in VPC plot</span></span></span>
<span class="r-in"><span><span class="va">xpdb</span><span class="op">@</span><span class="va">Data</span><span class="op">$</span><span class="va">SEX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">xpdb</span><span class="op">@</span><span class="va">Data</span><span class="op">$</span><span class="va">SEX</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2"</span>,<span class="st">"1"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">xpose.VPC</span><span class="op">(</span>by<span class="op">=</span><span class="st">"SEX"</span>,object<span class="op">=</span><span class="va">xpdb</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://katalog.uu.se/profile/?id=N4-631" class="external-link">Andrew C. Hooker</a>, Mats O. Karlsson, Justin J. Wilkins, E. Niclas Jonsson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

